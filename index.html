<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Học Từ Vựng - Flashcard Phiên Âm & Phát Âm Anh-Mỹ</title>
  <style>
    :root{
      --mint:#cff6ec;
      --mint-strong:#89e6cf;
      --accent:#2aa58a;
      --card:#ffffff;
      --text:#12343b;
      --soft:#eef9f6;
      --shadow: 0 6px 18px rgba(10,30,30,0.08);
      --round:16px;
    }
    *{box-sizing:border-box}
    body{
      font-family: "Inter", "Segoe UI", Roboto, Arial, sans-serif;
      background: linear-gradient(180deg, #f6fffd, #e9fbf8);
      color:var(--text);
      margin:0;
      padding:20px;
      -webkit-font-smoothing:antialiased;
    }
    .container{
      max-width:1000px;
      margin:0 auto;
    }
    header{
      display:flex;
      align-items:center;
      gap:16px;
      justify-content:space-between;
      margin-bottom:18px;
    }
    .brand{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo{
      width:64px;height:64px;border-radius:14px;background:linear-gradient(135deg,var(--mint-strong),var(--mint));
      display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow);
      font-weight:700;color:var(--accent);font-size:28px;
    }
    h1{margin:0;font-size:20px;}
    p.lead{margin:0;color:#176b60;opacity:0.9}

    /* topics */
    .topics{display:flex;gap:12px;margin:18px 0;flex-wrap:wrap}
    .topic-btn{
      background:var(--card);border:2px solid transparent;padding:12px 16px;border-radius:12px;cursor:pointer;
      box-shadow:var(--shadow);min-width:160px;text-align:left;transition:transform .18s,box-shadow .18s,border-color .18s;
      display:flex;align-items:center;gap:12px;
    }
    .topic-btn:hover{transform:translateY(-4px);box-shadow:0 10px 26px rgba(10,30,30,0.12)}
    .topic-emoji{font-size:22px}
    .topic-title{font-weight:700}
    .topic-sub{font-size:13px;color:#2f6b5f;opacity:0.9}

    /* area */
    .main{
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:20px;
      align-items:start;
    }

    /* card area */
    .card-wrap{display:flex;flex-direction:column;gap:14px;align-items:center}
    .card-stage{perspective:1200px;width:100%;max-width:560px;min-height:280px;display:flex;align-items:center;justify-content:center}
    .flashcard{
      width:100%;max-width:520px;height:280px;border-radius:16px;background:var(--card);box-shadow:var(--shadow);
      display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;cursor:pointer;
      transform-style:preserve-3d;transition:transform .6s;position:relative;
    }
    .flashcard.flipped{transform:rotateY(180deg)}
    .face{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:18px;backface-visibility:hidden;border-radius:16px}
    .front{background:linear-gradient(180deg,var(--soft),#ffffff);}
    .back{transform:rotateY(180deg);background:linear-gradient(180deg,#ffffff,var(--soft));}

    .word{font-size:36px;font-weight:800;margin-bottom:6px;color:var(--accent)}
    .ipa{font-size:18px;color:#176b60;margin-bottom:8px}
    .meaning{font-size:20px;font-weight:700;margin-bottom:6px}
    .example{font-size:16px;color:#2f6b5f;padding:0 6px;text-align:center}

    /* controls */
    .controls{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:6px}
    .btn{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;box-shadow:0 6px 18px rgba(29,120,95,0.12)}
    .btn.secondary{background:transparent;color:var(--accent);border:2px solid var(--accent)}

    .play-btn{background:transparent;border:2px dashed var(--accent);padding:8px 12px;border-radius:12px;color:var(--accent);cursor:pointer;font-weight:700}

    /* sidebar */
    .sidebar{background:var(--card);border-radius:14px;padding:16px;box-shadow:var(--shadow);min-height:220px}
    .progress{font-weight:800;color:var(--accent);margin-bottom:10px}
    .small{font-size:13px;color:#2f6b5f;margin-bottom:8px}
    .navs{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .navs .btn{background:var(--card);color:var(--accent);border:2px solid var(--mint-strong);padding:8px 10px;font-weight:700;border-radius:10px;box-shadow:none}

    /* finished */
    .finished{display:none;flex-direction:column;align-items:center;gap:12px}
    .show.finished{display:flex}

    /* responsive */
    @media(max-width:900px){
      .main{grid-template-columns:1fr; padding-bottom:30px}
      .sidebar{order:2}
    }

    footer{margin-top:20px;text-align:center;color:#2f6b5f;font-size:14px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">L</div>
        <div>
          <h1>Học Từ Vựng - Flashcard (Mint)</h1>
          <p class="lead">Phiên âm IPA • Giọng đọc Anh‑Mỹ • Ví dụ sinh động</p>
        </div>
      </div>
      <div>
        <button class="btn secondary" id="homeBtn" onclick="resetToHome()">Trang chủ</button>
      </div>
    </header>

    <div class="topics" id="topicsArea">
      <div class="topic-btn" onclick="selectTopic('travel')">
        <div class="topic-emoji">✈️</div>
        <div>
          <div class="topic-title">Du lịch</div>
          <div class="topic-sub">10 từ: airport, passport,...</div>
        </div>
      </div>
      <div class="topic-btn" onclick="selectTopic('food')">
        <div class="topic-emoji">🍎</div>
        <div>
          <div class="topic-title">Ẩm thực</div>
          <div class="topic-sub">10 từ: apple, bread,...</div>
        </div>
      </div>
      <div class="topic-btn" onclick="selectTopic('school')">
        <div class="topic-emoji">🏫</div>
        <div>
          <div class="topic-title">Trường học</div>
          <div class="topic-sub">10 từ: teacher, student,...</div>
        </div>
      </div>
    </div>

    <div class="main">
      <div class="card-wrap">
        <div class="card-stage">
          <div id="flashcard" class="flashcard" onclick="toggleFlip()">
            <div class="face front">
              <div class="word" id="wordText">Choose a topic</div>
              <div class="ipa" id="ipaText">/.../</div>
              <div style="font-size:14px;color:#0f5b4e">Nhấp vào thẻ để lật — nhấn nút 🔊 để nghe</div>
            </div>
            <div class="face back">
              <div class="meaning" id="meaningText"></div>
              <div class="example" id="exampleText"></div>
            </div>
          </div>
        </div>

        <div class="controls">
          <button class="btn" id="prevBtn" onclick="prevCard()">◀ Trước</button>
          <button class="play-btn" id="speakBtn" onclick="speakCurrent()">🔊 Nghe phát âm</button>
          <button class="btn" id="nextBtn" onclick="nextCard()">Tiếp ▶</button>
          <button class="btn secondary" id="flipBtn" onclick="toggleFlip()">Lật thẻ</button>
        </div>

        <div style="margin-top:8px;text-align:center;color:#176b60;font-weight:700" id="progressTxt"></div>

        <div class="finished" id="finishedBox">
          <img src="https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif" width="120" alt="congrats">
          <div style="font-size:18px;font-weight:800;color:var(--accent)">🎉 Tuyệt vời! Bạn đã hoàn thành chủ đề này!</div>
          <div style="display:flex;gap:10px">
            <button class="btn" onclick="restartTopic()">Học lại chủ đề này</button>
            <button class="btn secondary" onclick="resetToHome()">Về chủ đề</button>
          </div>
        </div>
      </div>

      <aside class="sidebar">
        <div class="progress" id="topicTitle">Chưa chọn chủ đề</div>
        <div class="small" id="topicDesc">Chọn một chủ đề ở bên trên để bắt đầu học.</div>
        <div style="margin-top:6px">
          <div style="font-weight:700;color:#176b60">Danh sách từ</div>
          <ol id="wordList" style="padding-left:18px;margin-top:6px"></ol>
        </div>

        <div style="margin-top:12px" class="navs">
          <button class="btn secondary" onclick="shuffleTopic()">Lộn xáo</button>
          <button class="btn secondary" onclick="showAllExamples()">Hiện ví dụ</button>
          <button class="btn secondary" onclick="speakCurrent(true)">Phát (từ + ví dụ)</button>
        </div>
      </aside>
    </div>

    <footer>Designed for Linh • Màu mint dễ thương • Mở bằng Chrome / Cốc Cốc / Edge hoặc trên điện thoại</footer>
  </div>

  <script>
    // Data: 3 topics x 10 words (with IPA, meaning, example)
    const DATA = {
      travel: {
        title: "Du lịch ✈️",
        desc: "Airport, passport, luggage…",
        words: [
          {en:"airport", ipa:"/ˈɛərpɔrt/", vi:"sân bay", ex:"We arrived at the airport three hours before the flight."},
          {en:"passport", ipa:"/ˈpæspɔrt/", vi:"hộ chiếu", ex:"Don't forget to bring your passport at the check-in counter."},
          {en:"luggage", ipa:"/ˈlʌɡɪdʒ/", vi:"hành lý", ex:"Her luggage was heavier than she expected."},
          {en:"ticket", ipa:"/ˈtɪkɪt/", vi:"vé", ex:"I bought a one-way ticket to the island."},
          {en:"boarding pass", ipa:"/ˈbɔrdɪŋ pæs/", vi:"thẻ lên máy bay", ex:"Show your boarding pass to the gate agent."},
          {en:"customs", ipa:"/ˈkʌstəmz/", vi:"hải quan", ex:"We had to declare some items at customs."},
          {en:"itinerary", ipa:"/aɪˈtɪnəˌrɛri/", vi:"lịch trình", ex:"Her itinerary included visits to three cities."},
          {en:"suitcase", ipa:"/ˈsuːtkeɪs/", vi:"vali", ex:"He packed his clothes into a small suitcase."},
          {en:"departure", ipa:"/dɪˈpɑrtʃər/", vi:"khởi hành", ex:"The departure time was delayed by an hour."},
          {en:"arrival", ipa:"/əˈraɪvəl/", vi:"đến nơi", ex:"We waited at the arrival hall for our friends."}
        ]
      },
      food: {
        title: "Ẩm thực 🍎",
        desc: "Apple, bread, chicken…",
        words: [
          {en:"apple", ipa:"/ˈæpəl/", vi:"táo", ex:"She ate a crisp apple as a quick snack."},
          {en:"bread", ipa:"/brɛd/", vi:"bánh mì", ex:"Fresh bread from the bakery smelled wonderful."},
          {en:"chicken", ipa:"/ˈtʃɪkən/", vi:"gà", ex:"They ordered grilled chicken with vegetables."},
          {en:"rice", ipa:"/raɪs/", vi:"cơm", ex:"A bowl of hot rice warmed him up."},
          {en:"noodles", ipa:"/ˈnuːdəlz/", vi:"mì", ex:"The street vendor served spicy noodles for dinner."},
          {en:"vegetables", ipa:"/ˈvɛdʒtəbəlz/", vi:"rau củ", ex:"She grows fresh vegetables in her small garden."},
          {en:"dessert", ipa:"/dɪˈzɜrt/", vi:"món tráng miệng", ex:"For dessert, we had chocolate cake."},
          {en:"snack", ipa:"/snæk/", vi:"đồ ăn nhẹ", ex:"He grabbed a quick snack between classes."},
          {en:"beverage", ipa:"/ˈbɛvərɪdʒ/", vi:"đồ uống", ex:"Cold beverages were available at the café."},
          {en:"restaurant", ipa:"/ˈrɛstərɑnt/", vi:"nhà hàng", ex:"They found a cozy restaurant by the river."}
        ]
      },
      school:{
        title:"Trường học 🏫",
        desc:"Teacher, student, classroom…",
        words:[
          {en:"teacher", ipa:"/ˈtiːtʃər/", vi:"giáo viên", ex:"The teacher praised her for excellent work."},
          {en:"student", ipa:"/ˈstuːdənt/", vi:"học sinh", ex:"Every student must submit their project on time."},
          {en:"classroom", ipa:"/ˈklæsˌruːm/", vi:"lớp học", ex:"The classroom was decorated with colorful posters."},
          {en:"homework", ipa:"/ˈhoʊmˌwɜrk/", vi:"bài tập về nhà", ex:"He did his homework before watching TV."},
          {en:"exam", ipa:"/ɪɡˈzæm/", vi:"kỳ thi", ex:"She studied all night for the important exam."},
          {en:"textbook", ipa:"/ˈtɛkstˌbʊk/", vi:"sách giáo khoa", ex:"Open your textbook to chapter five."},
          {en:"library", ipa:"/ˈlaɪˌbrɛri/", vi:"thư viện", ex:"They borrowed two books from the library."},
          {en:"desk", ipa:"/dɛsk/", vi:"bàn học", ex:"He kept his notebooks in the desk drawer."},
          {en:"pencil", ipa:"/ˈpɛnsəl/", vi:"bút chì", ex:"She sharpened her pencil before the test."},
          {en:"graduation", ipa:"/ˌɡrædʒuˈeɪʃən/", vi:"lễ tốt nghiệp", ex:"Graduation day was filled with joy and pride."}
        ]
      }
    };

    // State
    let currentTopicKey = null;
    let order = []; // indices in current topic
    let idx = 0;
    let flipped = false;

    // UI elements
    const wordText = document.getElementById('wordText');
    const ipaText = document.getElementById('ipaText');
    const meaningText = document.getElementById('meaningText');
    const exampleText = document.getElementById('exampleText');
    const topicTitle = document.getElementById('topicTitle');
    const topicDesc = document.getElementById('topicDesc');
    const wordList = document.getElementById('wordList');
    const progressTxt = document.getElementById('progressTxt');
    const flashcard = document.getElementById('flashcard');
    const finishedBox = document.getElementById('finishedBox');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    function selectTopic(key){
      currentTopicKey = key;
      const topic = DATA[key];
      topicTitle.textContent = topic.title;
      topicDesc.textContent = topic.desc;
      // build order and list
      order = [...Array(topic.words.length).keys()];
      idx = 0;
      renderWordList(topic.words);
      showCard();
      document.getElementById('finishedBox').classList.remove('show');
      flashcard.classList.remove('flipped');
    }

    function renderWordList(words){
      wordList.innerHTML='';
      words.forEach((w,i)=>{
        const li = document.createElement('li');
        li.textContent = (i+1)+'. '+w.en+' — '+w.vi;
        wordList.appendChild(li);
      });
    }

    function showCard(){
      if(currentTopicKey===null){
        wordText.textContent='Chọn chủ đề để bắt đầu';
        ipaText.textContent='/.../';
        meaningText.textContent='';
        exampleText.textContent='';
        progressTxt.textContent='';
        return;
      }
      const topic = DATA[currentTopicKey];
      if(idx < 0) idx = 0;
      if(idx >= topic.words.length){
        // finished
        wordText.textContent='';
        ipaText.textContent='';
        meaningText.textContent='';
        exampleText.textContent='';
        progressTxt.textContent = '';
        finishedBox.classList.add('show');
        return;
      }
      const w = topic.words[order[idx]];
      wordText.textContent = w.en;
      ipaText.textContent = w.ipa;
      meaningText.textContent = w.vi;
      exampleText.textContent = '"'+w.ex+'"';
      progressTxt.textContent = `Từ ${idx+1}/${topic.words.length}`;
    }

    function toggleFlip(){
      if(currentTopicKey===null) return;
      flipped = !flipped;
      flashcard.classList.toggle('flipped');
      // if we flipped to back, play example automatically
      if(flipped){
        // small delay then speak example
        setTimeout(()=>{ speakCurrent(true); }, 300);
      }
    }

    function nextCard(){
      const topic = DATA[currentTopicKey];
      if(!topic) return;
      idx++;
      flashcard.classList.remove('flipped');
      flipped=false;
      showCard();
    }

    function prevCard(){
      if(!currentTopicKey) return;
      idx--;
      if(idx<0) idx=0;
      flashcard.classList.remove('flipped');
      flipped=false;
      showCard();
    }

    function restartTopic(){
      order = [...Array(DATA[currentTopicKey].words.length).keys()];
      idx = 0;
      flashcard.classList.remove('flipped');
      flipped=false;
      finishedBox.classList.remove('show');
      showCard();
    }

    function resetToHome(){
      currentTopicKey = null;
      order = [];
      idx = 0;
      flashcard.classList.remove('flipped');
      flipped=false;
      topicTitle.textContent = 'Chưa chọn chủ đề';
      topicDesc.textContent = 'Chọn một chủ đề ở bên trên để bắt đầu học.';
      wordList.innerHTML='';
      document.getElementById('finishedBox').classList.remove('show');
      showCard();
      window.scrollTo({top:0,behavior:'smooth'});
    }

    function shuffleTopic(){
      if(!currentTopicKey) return;
      // Fisher-Yates shuffle
      for(let i=order.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [order[i],order[j]]=[order[j],order[i]];
      }
      idx=0;
      showCard();
    }

    function showAllExamples(){
      if(!currentTopicKey) return;
      const topic = DATA[currentTopicKey];
      let text = '';
      topic.words.forEach((w,i)=>{
        text += `${i+1}. ${w.en} (${w.ipa}) — ${w.vi}\n   Example: ${w.ex}\n\n`;
      });
      alert(text);
    }

    // Speech - Web Speech API (SpeechSynthesis) - try to use en-US voice
    function getUSVoice(){
      const voices = speechSynthesis.getVoices();
      // prefer en-US voices
      let voice = voices.find(v=>v.lang==='en-US' && /female|female/i.test(v.name)) || voices.find(v=>v.lang==='en-US') || voices[0];
      return voice;
    }

    // Speak current word or word+example if withExample true
    function speakCurrent(withExample=false){
      if(!currentTopicKey) return;
      const topic = DATA[currentTopicKey];
      if(idx>=topic.words.length) return;
      const w = topic.words[order[idx]];
      // build text: word, ipa (optional), then example
      let toSpeak = w.en + ". " + (withExample ? w.ex : "");
      // ensure any ongoing speech is cancelled
      speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(toSpeak);
      u.lang = 'en-US';
      // choose voice when available
      const voice = getUSVoice();
      if(voice) u.voice = voice;
      u.rate = 0.95;
      u.pitch = 1.0;
      speechSynthesis.speak(u);
    }

    // On load: try to load voices (some browsers require user interaction)
    window.addEventListener('load',()=>{
      showCard();
      // Chrome may load voices async
      speechSynthesis.onvoiceschanged = ()=>{ /* voices updated */ };
    });

    // enable keyboard for next/prev/flip
    window.addEventListener('keydown',(e)=>{
      if(!currentTopicKey) return;
      if(e.key==='ArrowRight') nextCard();
      if(e.key==='ArrowLeft') prevCard();
      if(e.key===' '){ e.preventDefault(); toggleFlip(); }
    });
  </script>
</body>
</html>
